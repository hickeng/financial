{"sheet":1,"id":"_","name":"ESPP","conditional_formatting":{"type":"bool","criteria":"NUMBER_NOT_EQUAL_TO","args":["=ROUND(Y7,3)","=U7",0,0],"ranges":["M7:M26","AF7:AF26","AF7:AF26","AE7:AE26","AE7:AE26"],"effect":["background: #FCE5CD","background: #FFFFFF","background: #A2C4C9","background: #D0E0E3"]}},
{"sheet":1,"id":"A1","data":"Input"},
{"sheet":1,"id":"A2","data":"From ESPP purchase confirmation docs"},
{"sheet":1,"id":"A4","data":"Purchase Begin Date"},
{"sheet":1,"id":"A7","type":"formula","format":"iso-date","propagate":{"end":"A26"},"dataclass":"in_ref"},
{"sheet":1,"id":"B3","data":"Input "},
{"sheet":1,"id":"B4","data":"1970-01-01","format":"iso-date"},
{"sheet":1,"id":"B7","data":"2012-08-01","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"B8","data":"2013-02-01","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"B9","data":"2013-08-01","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"B10","data":"2014-02-01","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"B11","data":"2014-08-01","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"B12","data":"2015-02-01","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"B13","data":"2015-08-01","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"B14","data":"2016-02-01","format":"iso-date","propagate":{"end":"B15"},"dataclass":"in_prepop"},
{"sheet":1,"id":"B16","data":"2017-02-01","format":"iso-date","propagate":{"end":"B17"},"dataclass":"in_prepop"},
{"sheet":1,"id":"B18","data":"2018-03-01","format":"iso-date","propagate":{"end":"B19"},"dataclass":"in_prepop"},
{"sheet":1,"id":"B20","data":"2019-03-01","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"B21","data":"2019-09-01","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"B22","data":"2020-03-01","format":"iso-date","propagate":{"end":"B23"},"dataclass":"in_prepop"},
{"sheet":1,"id":"B24","data":"2021-03-01","format":"iso-date","propagate":{"end":"B25"},"dataclass":"in_prepop"},
{"sheet":1,"id":"B26","data":"2022-03-01","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C4","data":"Purchase Date"},
{"sheet":1,"id":"C7","data":"2013-01-31","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C8","data":"=DATE(YEAR(C7),MONTH(C7)+6,DAY(C7))","type":"formula","format":"iso-date","propagate":{"end":"C10"},"dataclass":"in_prepop"},
{"sheet":1,"id":"C11","data":"2015-01-31","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C12","data":"=DATE(YEAR(C11),MONTH(C11)+6,DAY(C11))","type":"formula","format":"iso-date","propagate":{"end":"C14"},"dataclass":"in_prepop"},
{"sheet":1,"id":"C15","data":"2017-01-31","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C16","data":"2017-07-31","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C17","data":"2018-02-28","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C18","data":"2018-08-31","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C19","data":"2019-02-28","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C20","data":"2019-08-31","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C21","data":"2020-02-29","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C22","data":"2020-08-31","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C23","data":"2021-02-28","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C24","data":"2021-08-31","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C25","data":"2022-02-28","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"C26","data":"2022-08-31","format":"iso-date","dataclass":"in_prepop"},
{"sheet":1,"id":"D4","data":"Shares Purchased","note":"This is the value from \"Shares Purchased\" and NOT from \"Total shares Purchased for Offering\""},
{"sheet":1,"id":"D5","data":"=SUM(D7:D26)","type":"formula","format":"int","dataclass":"info"},
{"sheet":1,"id":"D7","format":"int","validation":{"type":"NUMBER_GREATER_THAN_OR_EQUAL_TO","values":0,"enforced":true,"help":""},"propagate":{"end":"D26"},"dataclass":"in"},
{"sheet":1,"id":"D28","data":"=SUM(D7:D26)","type":"formula","format":"int","dataclass":"info"},
{"sheet":1,"id":"E4","data":"Grant Date Market Value","format":"financial"},
{"sheet":1,"id":"E7","data":"89","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"E8","data":"78.79","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"E9","data":"82.1","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"E10","data":"90.14","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"E11","data":"98.33","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"E12","data":"77.1","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"E13","data":"89.13","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"E14","data":"45.49","format":"financial","propagate":{"end":"E15"},"dataclass":"in_prepop"},
{"sheet":1,"id":"E16","data":"87.19","format":"financial","propagate":{"end":"E17"},"dataclass":"in_prepop"},
{"sheet":1,"id":"E18","data":"123.66","format":"financial","propagate":{"end":"E19"},"dataclass":"in_prepop"},
{"sheet":1,"id":"E20","data":"178.2","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"E21","data":"141.44","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"E22","data":"120.52","format":"financial","propagate":{"end":"E23"},"dataclass":"in_prepop"},
{"sheet":1,"id":"E24","data":"140.41","format":"financial","propagate":{"end":"E25"},"dataclass":"in_prepop"},
{"sheet":1,"id":"E26","data":"115.91","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F4","data":"Purchase Value per Share"},
{"sheet":1,"id":"F7","data":"76.48","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F8","data":"82.19","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F9","data":"90.14","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F10","data":"99.36","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F11","data":"77.1","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F12","data":"89.13","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F13","data":"45.75","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F14","data":"72.98","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F15","data":"87.54","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F16","data":"92.71","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F17","data":"131.75","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F18","data":"153.26","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F19","data":"171.81","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F20","data":"141.44","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F21","data":"120.52","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F22","data":"144.44","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F23","data":"138.21","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F24","data":"148.87","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F25","data":"117.32","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"F26","data":"116.03","format":"financial","dataclass":"in_prepop"},
{"sheet":1,"id":"G4","data":"Current Contributions"},
{"sheet":1,"id":"G7","format":"financial","validation":{"type":"NUMBER_GREATER_THAN_OR_EQUAL_TO","values":0,"enforced":true,"help":""},"propagate":{"end":"G26"},"dataclass":"in"},
{"sheet":1,"id":"H3","data":"Derived - informational only"},
{"sheet":1,"id":"H4","data":"Total Price"},
{"sheet":1,"id":"H5","data":"=SUM(H7:H26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"H7","data":"=D7*L7","type":"formula","format":"financial","propagate":{"end":"H26"},"dataclass":"info"},
{"sheet":1,"id":"H28","data":"=SUM(H7:H26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"I3","data":"Derived - should match vlaues from ESPP purchase confirmation"},
{"sheet":1,"id":"I4","data":"Previous Carry Forward"},
{"sheet":1,"id":"I7","format":"financial","dataclass":"in","note":"Put the Previous Carry Forward form your earliest ESPP confirmation for shares you still own into this cell and it'll propagate down.\nIt doesn't matter that it's on a different row as it's only when you start purchasing shares that it'll have an effect.\nAlternatively you can 0 those rows for which you don't have a purchase and enter your earliest Carry Forward into the precise row."},
{"sheet":1,"id":"I8","data":"=K7","type":"formula","format":"financial","propagate":{"end":"I26"},"dataclass":"in_prepop"},
{"sheet":1,"id":"J4","data":"Total Contributions"},
{"sheet":1,"id":"J7","data":"=I7+G7","type":"formula","format":"financial","propagate":{"end":"J26"},"dataclass":"info"},
{"sheet":1,"id":"K4","data":"Carry Forward"},
{"sheet":1,"id":"K7","data":"=J7-H7","type":"formula","format":"financial","propagate":{"end":"K26"},"dataclass":"info"},
{"sheet":1,"id":"L4","data":"Purchase Price per Share"},
{"sheet":1,"id":"L7","data":"=0.85*MIN(E7,F7)","type":"formula","format":"int_4dp","propagate":{"end":"L13"},"dataclass":"info"},
{"sheet":1,"id":"L14","data":"=ROUND(0.85*MIN(E14,F14),2)","type":"formula","format":"int_2dp","propagate":{"end":"L26"},"dataclass":"info"},
{"sheet":1,"id":"M2","data":"From eTrade","format":"int_3dp"},
{"sheet":1,"id":"M3","data":"Input - alternate for cross check","format":"int_3dp"},
{"sheet":1,"id":"M4","data":"Share amounts from eTrade","format":"int_3dp","note":"The quantities of converted shares from eTrade lots.\nThe colour of the cell will alter slightly if the value here does not equal the value calculated via AVGO ratio.\nYou can toggle whether to use this manual value or the calculated value in the Tweaks on the first Sheet."},
{"sheet":1,"id":"M5","data":"=SUM(M7:M26)","type":"formula","format":"int_3dp","dataclass":"info"},
{"sheet":1,"id":"M7","format":"int_3dp","validation":{"type":"NUMBER_GREATER_THAN_OR_EQUAL_TO","values":0,"enforced":true,"help":""},"propagate":{"end":"M26"},"dataclass":"in_opt"},
{"sheet":1,"id":"M28","data":"=SUM(M7:M26)","type":"formula","format":"int_3dp","dataclass":"info"},
{"sheet":1,"id":"N3","data":"Use for fraction","format":"int_3dp","note":"If the fractional share should come out of a specific lot, or set of lots, check those lots here. If multiple are selected the sheet will spread the fraction equally over those lots, accounting for differences in cost-basis.\n\nFor me, eTrade took the entire fraction from a single lot and I expect that's what happened for most people.\n\nIf it came out of an ESPP lot, that's a sale and will incur the ordinary income portion of tax shown in column \"Income & short term gain\".\n\n"},
{"sheet":1,"id":"N4","format":"int_3dp"},
{"sheet":1,"id":"N5","data":"=COUNTIF(N7:N26, TRUE)","type":"formula"},
{"sheet":1,"id":"N7","type":"checkbox","format":"int_3dp","validation":{"type":"CHECKBOX","enforced":false,"help":""},"propagate":{"end":"N26"},"dataclass":"in"},
{"sheet":1,"id":"N28","data":"=COUNTIF(N7:N26, TRUE)","type":"formula"},
{"sheet":1,"id":"O2","format":"int_3dp"},
{"sheet":1,"id":"O3","data":"Ratio (shares)","format":"int_3dp"},
{"sheet":1,"id":"O4","data":"Derived from manual share qty","format":"int_3dp","note":"This value is calculated from the VMW -> AVGO ratio for the lot\n"},
{"sheet":1,"id":"O7","data":"=iferror(M7/(0.252*D7),0)","type":"formula","format":"int_6dp","propagate":{"end":"O26"},"dataclass":"info"},
{"sheet":1,"id":"P4","data":"Manual per-lot","format":"int_3dp","note":"Manual user entry per lot if using a per-lot election instead of pro-rata\n"},
{"sheet":1,"id":"P7","data":"=SWITCH(Q7,\"cash\",Reference!$E$5,\"shares\",Reference!$E$6,\"balance\",Reference!$E$7)","type":"formula","format":"int_6dp","propagate":{"end":"P26"},"dataclass":"info"},
{"sheet":1,"id":"Q4","data":"Prefer","format":"int_3dp"},
{"sheet":1,"id":"Q7","type":"dropdown","format":"int_6dp","validation":{"type":"VALUE_IN_LIST","values":["balance","cash","shares"],"enforced":true,"help":""},"propagate":{"end":"Q26"},"dataclass":"in_opt"},
{"sheet":1,"id":"Q27","data":"balance","propagate":{"end":"Q28"}},
{"sheet":1,"id":"R1","data":"Output","format":"financial"},
{"sheet":1,"id":"R2","data":"Calculated","format":"financial"},
{"sheet":1,"id":"R3","data":"Cash received","format":"financial"},
{"sheet":1,"id":"R4","data":"eTrade pro-rata","format":"financial"},
{"sheet":1,"id":"R5","data":"=SUM(R7:R26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"R7","data":"=Reference!$B$4*Reference!$B$3*$D7","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"R8","data":"=Reference!$B$4*Reference!$B$3*D8","type":"formula","format":"financial","propagate":{"end":"R26"},"dataclass":"info"},
{"sheet":1,"id":"R28","data":"=SUM(R7:R26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"S4","data":"derived eTrade per-lot","format":"financial"},
{"sheet":1,"id":"S5","data":"=SUM(S7:S26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"S7","data":"=iferror(LET(ratio, O7,(1-ratio) * Reference!$B$3 * $D7),0)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"S8","data":"=iferror(LET(ratio, O8,(1-ratio) * Reference!$B$3 * D8),0)","type":"formula","format":"financial","propagate":{"end":"S26"},"dataclass":"info"},
{"sheet":1,"id":"S28","data":"=SUM(S7:S26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"T4","data":"manual per-lot","format":"financial"},
{"sheet":1,"id":"T5","data":"=SUM(T7:T26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"T7","data":"=iferror(LET(ratio, P7,(1-ratio) * Reference!$B$3 * $D7),0)","type":"formula","format":"financial","propagate":{"end":"T26"},"dataclass":"info"},
{"sheet":1,"id":"T28","data":"=SUM(T7:T26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"U3","format":"financial"},
{"sheet":1,"id":"U4","data":"active amount","format":"financial"},
{"sheet":1,"id":"U5","data":"=SUM(U7:U26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"U7","data":"=SWITCH(Reference!$E$4,\"eTradeHoldingRatio\", R7, \"eTradeLotQtyRatio\",S7, \"manualLotRatio\", T7)","type":"formula","format":"financial","propagate":{"end":"U26"},"dataclass":"info"},
{"sheet":1,"id":"U28","data":"=SUM(U7:U26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"V3","data":"Basis adjustment for Dell dividends","format":"financial"},
{"sheet":1,"id":"V4","data":"1st special divident basis adjustment","format":"financial"},
{"sheet":1,"id":"V7","data":"=IF(C7<Reference!$B$26,Reference!$C$26,0)","type":"formula","format":"financial","propagate":{"end":"V26"},"dataclass":"info"},
{"sheet":1,"id":"W4","data":"2nd dividend basis adjustment","format":"financial"},
{"sheet":1,"id":"W7","data":"=IF(C7<Reference!$B$27,Reference!$C$27,0)","type":"formula","format":"financial","propagate":{"end":"W26"},"dataclass":"info"},
{"sheet":1,"id":"X3","data":"Cost basis entering merger","format":"financial"},
{"sheet":1,"id":"X4","data":"VMW tax-basis per share","format":"financial","note":"The cost basis is the actual price paid per share times the number of shares, plus the ordinary income."},
{"sheet":1,"id":"X7","data":"=(L7 /0.85)-V7-W7","type":"formula","format":"financial","propagate":{"end":"X26"},"dataclass":"info"},
{"sheet":1,"id":"Y3","data":"AVGO shares received","format":"financial"},
{"sheet":1,"id":"Y4","data":"eTrade pro-rata","format":"financial"},
{"sheet":1,"id":"Y5","data":"=SUM(Y7:Y26)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":1,"id":"Y7","data":"=$D7*Reference!$B$5*Reference!$B$6","type":"formula","format":"int_3dp","dataclass":"info"},
{"sheet":1,"id":"Y8","data":"=D8*Reference!$B$5*Reference!$B$6","type":"formula","format":"int_3dp","propagate":{"end":"Y26"},"dataclass":"info"},
{"sheet":1,"id":"Y28","data":"=SUM(Y7:Y26)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":1,"id":"Z4","data":"eTrade derived per-lot","format":"financial","note":"This should exactly equal the value in the \"Share amounts from eTrade\" column as it's literally inverted the calc.\n\nThis column is here purely for consistency so we can see all three stock columns together\n"},
{"sheet":1,"id":"Z5","data":"=SUM(Z7:Z26)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":1,"id":"Z7","data":"=$D7*O7*Reference!$B$6","type":"formula","format":"int_3dp","propagate":{"end":"Z26"},"dataclass":"info"},
{"sheet":1,"id":"Z28","data":"=SUM(Z7:Z26)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":1,"id":"AA4","data":"manual per-lot","format":"financial"},
{"sheet":1,"id":"AA5","data":"=SUM(AA7:AA26)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":1,"id":"AA7","data":"=$D7*P7*Reference!$B$6","type":"formula","format":"int_6dp","propagate":{"end":"AA26"},"dataclass":"info"},
{"sheet":1,"id":"AA28","data":"=SUM(AA7:AA26)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":1,"id":"AB3","format":"financial"},
{"sheet":1,"id":"AB4","data":"active qty","format":"financial"},
{"sheet":1,"id":"AB5","data":"=SUM(AB7:AB26)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":1,"id":"AB7","data":"=SWITCH(Reference!$E$4,\"eTradeHoldingRatio\", Y7, \"eTradeLotQtyRatio\",Z7, \"manualLotRatio\", AA7)","type":"formula","format":"int_6dp","propagate":{"end":"AB26"},"dataclass":"info"},
{"sheet":1,"id":"AB28","data":"=SUM(AB7:AB26)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":1,"id":"AC3","data":"Alternate gain calculation","format":"financial"},
{"sheet":1,"id":"AC4","data":"Gain (cash+FMV AVGO-basis)","format":"financial"},
{"sheet":1,"id":"AC5","data":"=SUM(AC7:AC26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"AC7","data":"=MAX(U7+(AB7*Reference!$B$18)-(D7*X7),0)","type":"formula","format":"financial","propagate":{"end":"AC26"},"dataclass":"info"},
{"sheet":1,"id":"AC28","data":"=SUM(AC7:AC26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"AD2","format":"financial"},
{"sheet":1,"id":"AD4","data":"Fractional share"},
{"sheet":1,"id":"AD5","data":"=SUM(AD7:AD26)","type":"formula","format":"int_4dp","dataclass":"out_now"},
{"sheet":1,"id":"AD7","data":"=IF(N7,Summary!$C$41/ ($N$28+RSU!J$86), 0)","type":"formula","format":"int_4dp","propagate":{"end":"AD26"},"dataclass":"info"},
{"sheet":1,"id":"AD28","data":"=SUM(AD7:AD26)","type":"formula","format":"int_4dp","dataclass":"out_now"},
{"sheet":1,"id":"AE2","data":"Now","format":"financial"},
{"sheet":1,"id":"AE3","data":"Gain"},
{"sheet":1,"id":"AE4","data":"Fraction"},
{"sheet":1,"id":"AE5","data":"=SUM(AE7:AE26)","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":1,"id":"AE7","data":"=IF(N7,(Reference!$B$23 - AI7) * AD7, 0)","type":"formula","format":"int_4dp","propagate":{"end":"AE26"},"dataclass":"out_now"},
{"sheet":1,"id":"AE28","data":"=SUM(AE7:AE26)","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":1,"id":"AF4","data":"Merger","format":"financial"},
{"sheet":1,"id":"AF5","data":"=SUM(AF7:AF26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"AF7","data":"=MIN(U7,AC7)","type":"formula","format":"financial","propagate":{"end":"AF26"},"dataclass":"out_now"},
{"sheet":1,"id":"AF28","data":"=SUM(AF7:AF26)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":1,"id":"AG3","data":"Treatment"},
{"sheet":1,"id":"AG4","data":"Income & short term gain","format":"financial","note":"This pulls in the ordinary income portion for the fractional share if associated with the lot."},
{"sheet":1,"id":"AG5","data":"=SUM(AG7:AG26)","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":1,"id":"AG7","data":"=IF(DATEDIF(C7,Reference!$B$28,\"Y\")>=1,0,AE7+AF7)+iferror(((AL7/D7)*AD7),0)","type":"formula","format":"financial","propagate":{"end":"AG26"},"dataclass":"out_now"},
{"sheet":1,"id":"AG28","data":"=SUM(AG7:AG26)","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":1,"id":"AH4","data":"Long term gain"},
{"sheet":1,"id":"AH5","data":"=SUM(AH7:AH26)","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":1,"id":"AH7","data":"=IF(DATEDIF(C7,Reference!$B$28,\"Y\")>=1,AE7+AF7,0)","type":"formula","format":"financial","propagate":{"end":"AH26"},"dataclass":"out_now"},
{"sheet":1,"id":"AH28","data":"=SUM(AH7:AH26)","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":1,"id":"AI2","data":"Future"},
{"sheet":1,"id":"AI3","data":"Reference for future sale"},
{"sheet":1,"id":"AI4","data":"AVGO tax-basis per share","note":"Cost basis on sale for disqualified ESPP includes the reported ordinary income.\n\nSee https://github.com/hickeng/financial/issues/15#issuecomment-1947700730"},
{"sheet":1,"id":"AI7","data":"=IFERROR(((X7*D7) - U7 + AF7 + IF(AK7, 0, AL7))/AB7, \"n/a\")","type":"formula","format":"financial","propagate":{"end":"AI26"},"dataclass":"out_future"},
{"sheet":1,"id":"AJ4","data":"Potential Captial Gain (AVGO)"},
{"sheet":1,"id":"AJ5","data":"=SUM(AJ28)","type":"formula","format":"financial","dataclass":"out_future"},
{"sheet":1,"id":"AJ7","data":"=iferror((Reference!$B$10-AI7)*(AB7) - AD7, 0)","type":"formula","format":"financial","propagate":{"end":"AJ26"},"dataclass":"out_future"},
{"sheet":1,"id":"AJ28","data":"=SUM(AJ7:AJ26)","type":"formula","format":"financial","dataclass":"out_future"},
{"sheet":1,"id":"AK4","data":"Qualified"},
{"sheet":1,"id":"AK5","format":"financial","dataclass":"out_future"},
{"sheet":1,"id":"AK7","data":"=AND(DATEDIF(B7,Reference!$B$29,\"Y\")>=1, DATEDIF(A7, Reference!$B$29, \"Y\")>=2)","type":"formula","format":"financial","propagate":{"end":"AK26"},"dataclass":"info"},
{"sheet":1,"id":"AK28","format":"financial","dataclass":"out_future"},
{"sheet":1,"id":"AL4","data":"Pending Ordinary Income"},
{"sheet":1,"id":"AL5","data":"=SUM(AL7:AL26)","type":"formula","format":"financial","dataclass":"out_future"},
{"sheet":1,"id":"AL7","data":"=IF(AK7,D7*0.15*MIN(E7,F7),D7*(F7-L7))","type":"formula","format":"financial","propagate":{"end":"AL26"},"dataclass":"out_future"},
{"sheet":1,"id":"AL28","data":"=SUM(AL7:AL26)","type":"formula","format":"financial","dataclass":"out_future"},
{"sheet":1,"id":"AM4","data":"Short Term Capital Gain"},
{"sheet":1,"id":"AM5","data":"=SUM(AM7:AM26)","type":"formula","format":"financial","dataclass":"out_future"},
{"sheet":1,"id":"AM7","data":"=IF(DATEDIF(C7,Reference!$B$29,\"Y\")>=1,0,AG7)","type":"formula","format":"financial","propagate":{"end":"AM26"},"dataclass":"out_future"},
{"sheet":1,"id":"AM28","data":"=SUM(AM7:AM26)","type":"formula","format":"financial","dataclass":"out_future"},
{"sheet":1,"id":"AN4","data":"Long Term Capital Gain"},
{"sheet":1,"id":"AN5","data":"=SUM(AN7:AN26)","type":"formula","format":"financial","dataclass":"out_future"},
{"sheet":1,"id":"AN7","data":"=AJ7","type":"formula","format":"financial","propagate":{"end":"AN26"},"dataclass":"out_future"},
{"sheet":1,"id":"AN28","data":"=SUM(AN7:AN26)","type":"formula","format":"financial","dataclass":"out_future"},
