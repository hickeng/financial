{"sheet":0,"id":"_","name":"Summary","conditional_formatting":{"type":"bool","criteria":"NUMBER_NOT_EQUAL_TO","args":["=B25+B26","=AND(EQ(K27, \"eTrade\"), NE(B30,C42))","=NE(K27,\"eTrade\")","=B42","=ROUNDDOWN(B26 * indirect(\"Reference!$B$6\"))"],"ranges":["B29","B30","B30","B30","B31","G42","F41"],"effect":["background: #DED5BA","background: #B7E1CD","background: #FF0000"]}},
{"sheet":0,"id":"A1","data":"=\"Colour Coding\"","type":"formula","dataclass":"info"},
{"sheet":0,"id":"A2","dataclass":"in"},
{"sheet":0,"id":"A3","dataclass":"in_opt"},
{"sheet":0,"id":"A4","data":"Input - necessary but prepopulated where available","dataclass":"in_prepop","note":"Missing necessary info is likely to occur when you have an ESPP from prior to 2012 or an RSU vest date that I did not.\nIn those cases you should be able to extra this info from the confirmation docs."},
{"sheet":0,"id":"A5","dataclass":"in_ref"},
{"sheet":0,"id":"A6","data":"Output - relevent immediately","dataclass":"out_now"},
{"sheet":0,"id":"A7","data":"Output - relevent on future sale","dataclass":"out_future"},
{"sheet":0,"id":"A8","data":"=\"Calculated - intermediate or informational\"","type":"formula","dataclass":"info"},
{"sheet":0,"id":"A9","data":"Labels"},
{"sheet":0,"id":"A10","data":"Example cell with additional note","note":"Sample note to illustrate the visual indication (black triangle in top right corner) of a cell note.\n"},
{"sheet":0,"id":"A12","data":"Github Release: v0.1.2"},
{"sheet":0,"id":"A22","data":"Inputs (eTrade transaction log)"},
{"sheet":0,"id":"A24","data":"Necessary"},
{"sheet":0,"id":"A25","data":"Shares liquidated for cash (vmw)","note":"This comes from the eTrade transaction log"},
{"sheet":0,"id":"A26","data":"Shares for conversion (vmw)","note":"This comes from the eTrade transaction log\n"},
{"sheet":0,"id":"A28","data":"Validations"},
{"sheet":0,"id":"A29","data":"VMW held at close","note":"VMW quantities for cash vs conversion should sum to the total holding.\nThis can also be checked against the sum of column D in the ESPP & RSU sheets"},
{"sheet":0,"id":"A30","data":"Cash for fraction","note":"cash for fraction should match the calculated value derived from the individual lot entries.\nThis can only be automatically validated when the value used for fractional share sale in Tweaks is the eTrade value."},
{"sheet":0,"id":"A31","data":"Cash portion without fraction","note":"should match the calculated value of cash portion calculated from individual lot values"},
{"sheet":0,"id":"A36","data":"Outputs"},
{"sheet":0,"id":"A38","data":"Merger"},
{"sheet":0,"id":"A41","data":"Shares"},
{"sheet":0,"id":"A42","data":"Dollars"},
{"sheet":0,"id":"A44","data":"Pending"},
{"sheet":0,"id":"A48","data":"Tax Impact"},
{"sheet":0,"id":"A53","data":"Federal  - total"},
{"sheet":0,"id":"A54","data":"Federal - income & short term gain"},
{"sheet":0,"id":"A55","data":"Federal - long term gain"},
{"sheet":0,"id":"A56","data":"California"},
{"sheet":0,"id":"A57","data":"Totals"},
{"sheet":0,"id":"B25","format":"int","propagate":{"end":"B26"},"dataclass":"in"},
{"sheet":0,"id":"B29","format":"int","validation":{"type":"NUMBER_EQUAL_TO","values":"=B25+B26","enforced":false,"help":""},"dataclass":"in_opt"},
{"sheet":0,"id":"B30","format":"financial","propagate":{"end":"B31"},"dataclass":"in_opt"},
{"sheet":0,"id":"B40","data":"Cash consideration"},
{"sheet":0,"id":"B42","data":"=Reference!B31","type":"formula","format":"financial","dataclass":"info","note":"This is what would have been deposited in your individual brokerage account or similar.\nThe Gains and the Fractional sale are the amounts you need to pay tax on."},
{"sheet":0,"id":"B48","data":"WARNING"},
{"sheet":0,"id":"B51","data":"Liability"},
{"sheet":0,"id":"B52","data":"Actual"},
{"sheet":0,"id":"B53","data":"=C54+C55","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":0,"id":"B54","format":"financial","propagate":{"end":"B55"}},
{"sheet":0,"id":"B56","data":"=Reference!B59","type":"formula","format":"financial","dataclass":"out_now","note":"Does NOT currently factor deductions as they're different values from federal."},
{"sheet":0,"id":"B57","data":"=B53+B56","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":0,"id":"C1","data":"Instructions"},
{"sheet":0,"id":"C2","data":"0. Check the colour coding to the left - it should be useful particularly when adding info into the data grids on the other Sheets"},
{"sheet":0,"id":"C3","data":"1. Collect eTrade confirmations for all shares held over the acquisition (Stock Plan Account -> My Account -> Stock Plan Confirmations)"},
{"sheet":0,"id":"C4","data":"2. Collect eTrade transaction log entries relating to acquisition (propably between 2023-11-21 and 2023-12-09)"},
{"sheet":0,"id":"C9","data":"3. Collect number of AVGO in each lot - these should be entered into the \"Share amounts from eTrade\" columns in ESPP and RUS datagrids and are visible in OSPS if you still hold them in eTrade. If not, then you will have to either use the calculated values only or derived the info via other means."},
{"sheet":0,"id":"C10","data":"4. Add validation - total number of VMW shares held to acquisition goes into B29"},
{"sheet":0,"id":"C11","data":"5. 2023 W2 values go into G26 to G30 as indicated at the cells"},
{"sheet":0,"id":"C12","data":"6. 2022 total federal tax paid goes into G25 - used to calculate safe harbor amounts"},
{"sheet":0,"id":"C13","data":"7. Enter values into the RSU and ESPP sheets - if you need to add a row, you can insert, select the entire row above or below without unhiding columns, fill into the new row, and replace the values with yours. Sanity check the SUM ranges in the totals row includes the full range."},
{"sheet":0,"id":"C17","data":"8. For the fractional share - if you're providing the manual values for number of shares, add the fractional amount back into any lot it came from if deducted. This avoids needing a single row with different handling based on whether the manual value has a fraction removed or not."},
{"sheet":0,"id":"C19","data":"9. Look for the little black triangles in the top right corner of cells, including headers. This indicates a note. Generally I've tried to add notes useful to explaining how the sheet and any given calculation works"},
{"sheet":0,"id":"C20","data":"10. Look for the horizontal paired arrows between column labels in the RSU and ESPP sheets - these allow you to expand the hidden columns if you want to see the informational and intermediate calculations"},
{"sheet":0,"id":"C40","data":"Fractional Share"},
{"sheet":0,"id":"C41","data":"=MOD(ESPP!AB5+RSU!Y5,1)","type":"formula","format":"int_4dp","validation":{"type":"NUMBER_EQUAL_TO","values":"=ESPP!AD28+RSU!AA86","enforced":false,"help":"Check at least one box to select a lot for the fraction to associate with"},"dataclass":"info"},
{"sheet":0,"id":"C42","data":"=ROUND(C41*Reference!B23,2)","type":"formula","format":"financial","dataclass":"info","note":"This is the cash value received for the fractional share. The Gain associated with that sale in rolled into the appropriate Long or Short term gain bucket."},
{"sheet":0,"id":"C48","data":"There WILL be errors in the tax estimation. It doesn't even attempt AMT. I'm uncertain about how LTG progressiveness works"},
{"sheet":0,"id":"C49","data":"The numbers you want for tax planning are the Gains in the section above"},
{"sheet":0,"id":"C52","data":"of which"},
{"sheet":0,"id":"C53","format":"financial"},
{"sheet":0,"id":"C54","data":"=Reference!B57","type":"formula","format":"financial","dataclass":"info","note":"This is calculated progressively using the 2023 thresholds, and factoring in the 2023 W2 and other income/deductions from the inputs."},
{"sheet":0,"id":"C55","data":"=Reference!B58","type":"formula","format":"financial","dataclass":"info","note":"This is calculated using an estimated AGI for 2023 from the values in inputs and the income/stg element to decide the ltg rate that applies.\n\nI do want to confirm that LTG isn't fully progressive. The threshold mechanism would leave patches where you'd net less for earning more as you just cleared thresholds.\n\nTracked in https://github.com/hickeng/financial/issues/3"},
{"sheet":0,"id":"C56","format":"financial"},
{"sheet":0,"id":"C57","format":"financial","dataclass":"info"},
{"sheet":0,"id":"D5","data":"a. \"VMW SHARES AZH26 TENDER PAYMENT PRORATED 52.09%\" - prefix value goes into B26"},
{"sheet":0,"id":"D6","data":"b. \"CONTRA VMWARE, INC EXCHANGE FOR CASH\" - prefix value goes into B25"},
{"sheet":0,"id":"D7","data":"c. \"CONTRA VMWARE, INC EXCHANGE FOR CASH\" - credited dollar value goes into B31"},
{"sheet":0,"id":"D8","data":"d. \"BROADCOM INC CASH IN LIEU OF FRACTIONS\" - credited dollar value goes in B30"},
{"sheet":0,"id":"D14","data":"a. Enter values from ESPP purchase confirmation documents into the ESPP Sheet - the column heading exactly match the field names from the docs"},
{"sheet":0,"id":"D15","data":"b. Enter values from RSU release confirmation documents into the RSU Sheet - the column headings exactly match the field names from the docs. I've left duplicate release date rows in the sheet where I had multiple vests, given it's easier to enter 0 for a row than insert a new one."},
{"sheet":0,"id":"D16","data":"c. It's expected you'll need to add rows for RSU grants where you had more than one vest on a given date - in that case it's easiest to insert a row below the entry for the corresponding date, copy the entire populated row down to get the release date and market value, then fill in the specific share quantity for the lot."},
{"sheet":0,"id":"D18","data":"a. Check the Fraction box for any lot you want to the fraction to be attributed to. The fraction is evenly spread across the selected lots."},
{"sheet":0,"id":"D22","data":"Inputs (W2 & 1040)"},
{"sheet":0,"id":"D24","data":"Form"},
{"sheet":0,"id":"D25","data":"1040 (tax return)"},
{"sheet":0,"id":"D26","data":"W2","propagate":{"end":"D29"}},
{"sheet":0,"id":"D40","data":"Gain (Short)"},
{"sheet":0,"id":"D42","data":"=ESPP!AG5+RSU!AD5","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":0,"id":"D44","data":"=RSU!AH5","type":"formula","format":"financial","dataclass":"out_future"},
{"sheet":0,"id":"D51","data":"Safe Harbor"},
{"sheet":0,"id":"D52","data":"Threshold"},
{"sheet":0,"id":"D53","data":"=1.1*G25","type":"formula","format":"financial","dataclass":"out_now","note":"Worst case safe harbor for federal is 110% of previous years assessed taxes per filed 1040.\n\nTODO: add calc to References for the 90% and 100% scenarios\n"},
{"sheet":0,"id":"D56","data":"=0.9 * B56","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":0,"id":"D57","data":"=SUM(D53:D56)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":0,"id":"E24","data":"Year"},
{"sheet":0,"id":"E25","data":"2022"},
{"sheet":0,"id":"E26","data":"2023","propagate":{"end":"E29"}},
{"sheet":0,"id":"E40","data":"Gain (Long)"},
{"sheet":0,"id":"E42","data":"=ESPP!AH5+RSU!AE5","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":0,"id":"E44","data":"=RSU!AI5+ESPP!AN5","type":"formula","format":"financial","dataclass":"out_future","note":"This estimate may drop if it turns out the symmetric treatment suggested in https://github.com/hickeng/financial/issues/15#issuecomment-1948444299 is the correct approach for calculating gain on sale of qualified ESPPs\n"},
{"sheet":0,"id":"E52","data":"Outstanding"},
{"sheet":0,"id":"E53","data":"=D53-G27","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":0,"id":"E56","data":"=D56-G29","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":0,"id":"E57","data":"=SUM(E53:E56)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":0,"id":"F24","data":"Box"},
{"sheet":0,"id":"F25","data":"24","format":"int"},
{"sheet":0,"id":"F26","data":"1","format":"int"},
{"sheet":0,"id":"F27","data":"2","format":"int"},
{"sheet":0,"id":"F28","data":"16","format":"int"},
{"sheet":0,"id":"F29","data":"17","format":"int"},
{"sheet":0,"id":"F30","format":"int"},
{"sheet":0,"id":"F40","data":"Shares (FMV)"},
{"sheet":0,"id":"F41","data":"=ROUNDDOWN(ESPP!AB5+RSU!Y5)","type":"formula","dataclass":"info"},
{"sheet":0,"id":"F42","data":"=F41*Reference!B18","type":"formula","format":"financial","dataclass":"info"},
{"sheet":0,"id":"F51","data":"Estimated Taxes"},
{"sheet":0,"id":"F52","data":"Paid"},
{"sheet":0,"id":"F53","format":"financial","dataclass":"in"},
{"sheet":0,"id":"F56","format":"financial","dataclass":"in"},
{"sheet":0,"id":"F57","data":"=SUM(F53:F56)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":0,"id":"G24","dataclass":"in_opt"},
{"sheet":0,"id":"G25","format":"financial","propagate":{"end":"G29"},"dataclass":"in_opt"},
{"sheet":0,"id":"G30","format":"financial"},
{"sheet":0,"id":"G40","data":"Taxable income"},
{"sheet":0,"id":"G44","data":"=ESPP!AL5","type":"formula","format":"financial","dataclass":"out_future","note":"This is the pending tax on ESPP discount. It will reach minimum after 2024-03-01 when the final ESPP lot qualifies."},
{"sheet":0,"id":"G52","data":"Owed"},
{"sheet":0,"id":"G53","data":"=B53-G27-F53","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":0,"id":"G56","data":"=B56-G29-F56","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":0,"id":"G57","data":"=SUM(G53:G56)","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":0,"id":"H24","data":"Comment"},
{"sheet":0,"id":"H25","data":"Federal tax (prior year)"},
{"sheet":0,"id":"H26","data":"Federal income"},
{"sheet":0,"id":"H27","data":"Federal tax paid"},
{"sheet":0,"id":"H28","data":"State income"},
{"sheet":0,"id":"H29","data":"State tax paid"},
{"sheet":0,"id":"J22","data":"Inputs (Tweaks)"},
{"sheet":0,"id":"J25","data":"AVGO FMV"},
{"sheet":0,"id":"J26","data":"Cash/stock ratio","note":"Calculated from Necessary Inputs\n- uses the qty of shares from eTrade transaction log entered into Necessary Inputs to derive a pro-rata ratio\n\nCalculated from manual share qty\n- uses the manual entry per-lot of share qty from eTrade OSPS holdings to calculate the effective ratio used per lot\n\nManual per-lot ratio\n- uses a manual entry per-lot for the ratio. If using a manual lot ratio, the effective total ratio must still match exactly the overall transaction ratio.\n- This is mostly so I can assess whether it's even worth asking a CPA to look into it.\n- See https://github.com/hickeng/financial/issues/10\n"},
{"sheet":0,"id":"J27","data":"Factional share value"},
{"sheet":0,"id":"J28","data":"Post merger sale of AVGO","dataclass":"out_future","note":"Lets you look at the LTG/STG shift based on potential sale dates of the converted AVGO.\n\nIf you set this to last year, then the numbers will be rolled into the tax estimation, so that if you sold in 2023 but post merge this setting is for you.\n\nThis is unlikely to have any effect if using optimized manual lots as the newer lots will all have been assigned to cash."},
{"sheet":0,"id":"J30","data":"Other Captial Gain (Short)"},
{"sheet":0,"id":"J31","data":"Other Captial Gain (Long)"},
{"sheet":0,"id":"J32","data":"Other income"},
{"sheet":0,"id":"J33","data":"Status"},
{"sheet":0,"id":"J34","data":"Deduction"},
{"sheet":0,"id":"J36","data":"Display of lot values","note":"https://github.com/hickeng/financial/issues/25\n\ntracking adding per-lot display that's more suited to transfer to costbasis.com calculator."},
{"sheet":0,"id":"K25","data":"Mean","type":"dropdown","validation":{"type":"VALUE_IN_LIST","values":["Mean","Close","High","Low","Custom"],"enforced":true,"help":""},"dataclass":"in_prepop"},
{"sheet":0,"id":"K26","data":"Calculated from Necessary Inputs","type":"dropdown","validation":{"type":"VALUE_IN_LIST","values":["Calculated from Necessary Inputs","Calculated from manual share qty","Manual per-lot ratio"],"enforced":true,"help":""},"dataclass":"in_prepop"},
{"sheet":0,"id":"K27","data":"eTrade","type":"dropdown","validation":{"type":"VALUE_IN_LIST","values":["eTrade","Form 8937","Custom"],"enforced":true,"help":""},"dataclass":"in_prepop"},
{"sheet":0,"id":"K28","data":"today","type":"dropdown","validation":{"type":"VALUE_IN_LIST","values":["last year","today","2024-03-01","2024-05-01","2024-06-01","2024-08-01","2024-09-01"],"enforced":false,"help":"Click and enter a value from the list of items"},"dataclass":"in_prepop"},
{"sheet":0,"id":"K30","format":"financial","propagate":{"end":"K32"},"dataclass":"in_opt"},
{"sheet":0,"id":"K33","type":"dropdown","validation":{"type":"VALUE_IN_LIST","values":["Single","Joint","Head of household"],"enforced":true,"help":""},"dataclass":"in_opt"},
{"sheet":0,"id":"K34","type":"dropdown","validation":{"type":"VALUE_IN_LIST","values":["By status","Custom"],"enforced":true,"help":""},"dataclass":"in_opt"},
{"sheet":0,"id":"K36","type":"dropdown","validation":{"type":"VALUE_IN_LIST","values":["per-share"],"enforced":true,"help":""},"dataclass":"in_ref"},
{"sheet":0,"id":"L24","data":"Active"},
{"sheet":0,"id":"L25","data":"=Reference!B18","type":"formula","format":"financial","dataclass":"info"},
{"sheet":0,"id":"L27","data":"=Reference!B23","type":"formula","format":"financial","dataclass":"info"},
{"sheet":0,"id":"L28","data":"  @ "},
{"sheet":0,"id":"L34","data":"=SWITCH(K34, \"By status\", SWITCH(K33,\"Single\",Reference!B36,\"Joint\",Reference!C36,\"Head of household\",Reference!D36), \"Custom\",M34)","type":"formula","dataclass":"info"},
{"sheet":0,"id":"M24","data":"Custom","note":"Present if you want to experiment with different values for these inputs."},
{"sheet":0,"id":"M25","format":"financial","dataclass":"in_opt"},
{"sheet":0,"id":"M27","format":"financial","dataclass":"in_opt"},
{"sheet":0,"id":"M28","type":"formula","format":"[$$]#,##0.00","validation":{"type":"NUMBER_GREATER_THAN","values":0,"enforced":true,"help":""},"dataclass":"in_opt"},
{"sheet":0,"id":"M34","dataclass":"in_opt"},
{"sheet":0,"id":"M40","data":" "},
{"sheet":0,"id":"N34","data":"Doesn't apply to State"},
