{"sheet":0,"id":"_","name":"RSU","conditional_formatting":{"type":"bool","criteria":"NUMBER_NOT_EQUAL_TO","args":["=ROUND(AB7,3)","=W7",0,"=AA7"],"ranges":["I7:I150","AI7:AI150","AH7:AH150","K7:K150"],"effect":["background: #FCE5CD","background: #A2C4C9","background: #FCE5CD"]}},
{"sheet":2,"id":"A1","data":"Input"},
{"sheet":2,"id":"A2","data":"From RSU release confirmation docs"},
{"sheet":2,"id":"A4","data":"Award Number"},
{"sheet":2,"id":"A7","propagate":{"end":"A150"},"dataclass":"in_ref"},
{"sheet":2,"id":"B3","data":"Input "},
{"sheet":2,"id":"B4","data":"Award Date"},
{"sheet":2,"id":"B7","format":"iso-date","propagate":{"end":"B150"},"dataclass":"in_ref"},
{"sheet":2,"id":"C4","data":"Release Date"},
{"sheet":2,"id":"C6","data":"Required"},
{"sheet":2,"id":"C7","format":"yyyy\"-\"mmm\"-\"dd","dataclass":"in","note":"Enter the Release Date for the RSU lots in this column.\n\nThis will be used to retrieve the market value for that date.\n\nSee https://github.com/hickeng/financial/blob/main/usage.md#rsu for details\n\n"},
{"sheet":2,"id":"C8","format":"yyyy\"-\"mmm\"-\"dd","propagate":{"end":"C150"},"dataclass":"in"},
{"sheet":2,"id":"D4","data":"Shares Issued"},
{"sheet":2,"id":"D5","data":"=SUM(D7:D)","type":"formula","format":"int","dataclass":"info"},
{"sheet":2,"id":"D6","data":"Required"},
{"sheet":2,"id":"D7","format":"int","validation":{"type":"NUMBER_GREATER_THAN_OR_EQUAL_TO","values":0,"enforced":true,"help":""},"dataclass":"in","note":"Enter the number of shares from this ESPP lot that you held over the date of the merger.\n\nThis is the value from \"Shares Issued\" and NOT from \"Award Shares\". \nIf you were Awarded 73 shares:\n* Shares Traded: ~26 would have been withheld to cover tax and can be entered into column F for reference\n* Shares Issued: ~47 would have been assigned to you and would go in this column\n\nIf you've sold any since release, adjust the number to reflect that.\n\nSee https://github.com/hickeng/financial/blob/main/usage.md#espp"},
{"sheet":2,"id":"D8","format":"int","validation":{"type":"NUMBER_GREATER_THAN_OR_EQUAL_TO","values":0,"enforced":true,"help":""},"propagate":{"end":"D150"},"dataclass":"in"},
{"sheet":2,"id":"E4","data":"Market Value Per Share"},
{"sheet":2,"id":"E7","data":"=IF(C7<>\"\", IFERROR(VLOOKUP(C7, SORT(PriceReference!$A$1:$B), 2, TRUE), \"price unavailable\"), \"\")","type":"formula","format":"financial","propagate":{"end":"E150"},"dataclass":"info"},
{"sheet":2,"id":"F3","data":"Input for calculating tax withheld"},
{"sheet":2,"id":"F4","data":"Shares Traded"},
{"sheet":2,"id":"F6","data":"Optional"},
{"sheet":2,"id":"F7","format":"int","dataclass":"in_opt","note":"This is an optional field to let you capture the per-vest shares that were withheld for taxes.\n\nThese withheld shares would have shown up as taxes paid on your W2 for the year. It's here only to allow a single location with all related info. This column does NOT impact the merger calculations and can be safely omitted.\n"},
{"sheet":2,"id":"F8","format":"int","propagate":{"end":"F150"},"dataclass":"in_opt"},
{"sheet":2,"id":"G3","data":"Derived - informational only"},
{"sheet":2,"id":"G4","data":"Tax basis on receipt"},
{"sheet":2,"id":"G5","data":"=SUM(G7:G)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":2,"id":"G7","data":"=IFERROR(D7*E7,0)","type":"formula","format":"financial","propagate":{"end":"G150"},"dataclass":"info"},
{"sheet":2,"id":"H4","data":"Tax paid on receipt"},
{"sheet":2,"id":"H5","data":"=SUM(H7:H)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":2,"id":"H7","data":"=IFERROR(F7*E7,0)","type":"formula","format":"financial","propagate":{"end":"H150"},"dataclass":"info"},
{"sheet":2,"id":"I2","data":"From eTrade"},
{"sheet":2,"id":"I3","data":"Input - alternate for cross check"},
{"sheet":2,"id":"I4","data":"AVGO qty from eTrade"},
{"sheet":2,"id":"I5","data":"=SUM(I7:I)","type":"formula","format":"int_3dp","dataclass":"info"},
{"sheet":2,"id":"I6","data":"Optional"},
{"sheet":2,"id":"I7","format":"int_3dp","validation":{"type":"NUMBER_GREATER_THAN_OR_EQUAL_TO","values":0,"enforced":true,"help":""},"dataclass":"in_opt","note":"This is an optional input.\n\nYou can use it to:\na. track the qty that etrade assocaited with the lot\nb. use a derived per-lot ratio for cash/stack from etrade's number by setting the \"Cash/stock ratio\" tweak on the Summary page to \"Pro-rata - from eTrade share qty\"\n\nThis is the quantities of converted shares from eTrade lots as reported by eTrade. The colour of the cell will alter slightly if the value here does not equal the value calculated via AVGO ratio.\n\nYou can toggle whether to use this manual value or the calculated value in the Tweaks on the first Sheet.\n\nIf this is the lot from which a fraction was taken by etrade then you should add then fractional AVGO quantity back into this value and check the Fraction box. See the note on the fraction column."},
{"sheet":2,"id":"I8","format":"int_3dp","validation":{"type":"NUMBER_GREATER_THAN_OR_EQUAL_TO","values":0,"enforced":true,"help":""},"propagate":{"end":"I150"},"dataclass":"in_opt"},
{"sheet":2,"id":"J4","data":"Use for fraction"},
{"sheet":2,"id":"J5","data":"=COUNTIF(J7:J, TRUE)","type":"formula"},
{"sheet":2,"id":"J6","data":"Required"},
{"sheet":2,"id":"J7","type":"checkbox","format":"int_3dp","validation":{"type":"CHECKBOX","enforced":false,"help":""},"dataclass":"in","note":"Almost everyone will have a fractional AVGO share after conversion. For many people this is take from their oldest or newest lot. \n\nCheck the box for the lot the fraction was taken from and add the fractional amount back into to \"AVGO qty from eTrade\" column.\n\nSee the usage docs for details on how to determine the appropriate lot\nhttps://github.com/hickeng/financial/blob/main/usage.md#factional-share\n\n\nNotes:\nIf the fractional share should come out of a specific lot, or set of lots, check those lots here. If multiple are selected the sheet will spread the fraction equally over those lots, accounting for differences in cost-basis.\n\nIf it came out of an ESPP lot, that's a sale and will incur the ordinary income portion of tax shown in column \"Income & short term gain\".\n\nThe fractional quantity should be added back into \"AVGO qty from eTrade\" column for the lot that eTrade took it from.\nThis is done because we need the cost-basis of the lot calculated _before_ that fraction is removed as it's a serial conversion - convert entire lot, THEN sell factional part. It also avoids substantial complexity in formulae.\n"},
{"sheet":2,"id":"J8","type":"checkbox","format":"int_3dp","validation":{"type":"CHECKBOX","enforced":false,"help":""},"propagate":{"end":"J150"},"dataclass":"in"},
{"sheet":2,"id":"K3","data":"1099-B "},
{"sheet":2,"id":"K4","data":"Proceeds (1d)"},
{"sheet":2,"id":"K7","format":"financial","propagate":{"end":"K150"},"dataclass":"in_opt"},
{"sheet":2,"id":"L4","data":"Cost or Other Basis (1e)","note":"Pre-filled with 0.00 because that's what eTrade has reported for everyone."},
{"sheet":2,"id":"L7","format":"financial","propagate":{"end":"L150"},"dataclass":"in_opt"},
{"sheet":2,"id":"M4","data":"Accrued Market Discount (1f)"},
{"sheet":2,"id":"M7","format":"financial","propagate":{"end":"M150"},"dataclass":"in_opt"},
{"sheet":2,"id":"N4","data":"Wash Sale Loss Disallowed (1g)"},
{"sheet":2,"id":"N7","format":"financial","propagate":{"end":"N150"},"dataclass":"in_opt"},
{"sheet":2,"id":"O4","data":"Gain/Loss Amount"},
{"sheet":2,"id":"O7","format":"financial","propagate":{"end":"O150"},"dataclass":"in_opt"},
{"sheet":2,"id":"P4","data":"Federal Income Tax Withheld (4)"},
{"sheet":2,"id":"P7","format":"financial","propagate":{"end":"P150"},"dataclass":"in_opt"},
{"sheet":2,"id":"Q3","data":"Ratio (shares)"},
{"sheet":2,"id":"Q4","data":"Derived from manual share qty","note":"This value is calculated from the VMW -> AVGO ratio for the lot using the \"AVGO qty from eTrade\" for the AVGO quantity\n"},
{"sheet":2,"id":"Q7","data":"=iferror(I7/(0.252*D7),0)","type":"formula","format":"int_6dp","propagate":{"end":"Q150"},"dataclass":"info"},
{"sheet":2,"id":"R4","data":"Manual per-lot","note":"Manual user entry per lot if using a per-lot election instead of pro-rata\n"},
{"sheet":2,"id":"R7","data":"=SWITCH(S7,\"cash\",Reference!E$5,\"shares\",Reference!$E$6,\"balance\",Reference!$E$7,\"pro-rata\",Reference!$B$5)","type":"formula","format":"int_6dp","propagate":{"end":"R150"},"dataclass":"info"},
{"sheet":2,"id":"S4","data":"Prefer"},
{"sheet":2,"id":"S6","data":"Optional"},
{"sheet":2,"id":"S7","type":"dropdown","format":"int_6dp","validation":{"type":"VALUE_IN_LIST","values":["balance","cash","shares","pro-rata"],"enforced":true,"help":""},"dataclass":"in_opt","note":"This is an optional field.\n\nThe value selected here will only reflect in the wider sheet if the \"Per-lot - from strategy or manual selection\" has been selected for the ratio source in the Tweaks on the Summary sheet."},
{"sheet":2,"id":"S8","type":"dropdown","format":"int_6dp","validation":{"type":"VALUE_IN_LIST","values":["balance","cash","shares","pro-rata"],"enforced":true,"help":""},"propagate":{"end":"S150"},"dataclass":"in_opt"},
{"sheet":2,"id":"T1","data":"Output"},
{"sheet":2,"id":"T2","data":"Calculated"},
{"sheet":2,"id":"T3","data":"Cash received"},
{"sheet":2,"id":"T4","data":"eTrade pro-rata"},
{"sheet":2,"id":"T5","data":"=SUM(T7:T)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":2,"id":"T7","data":"=LET(numVmwShares,D7, cashRatio,Reference!$B$4, vmwFinalPrice,Reference!$B$3, numVmwShares * cashRatio * vmwFinalPrice)","type":"formula","format":"int_4dp","propagate":{"end":"T150"},"dataclass":"info"},
{"sheet":2,"id":"U4","data":"derived eTrade per-lot"},
{"sheet":2,"id":"U5","data":"=SUM(U7:U)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":2,"id":"U7","data":"=iferror(LET(numVmwShares,$D7, stockRatio,Q7, vmwFinalPrice,Reference!$B$3, (1 - stockRatio) * vmwFinalPrice * numVmwShares),0)","type":"formula","format":"int_4dp","propagate":{"end":"U150"},"dataclass":"info"},
{"sheet":2,"id":"V4","data":"manual per-lot"},
{"sheet":2,"id":"V5","data":"=SUM(V7:V)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":2,"id":"V7","data":"=iferror(LET(numVmwShares,$D7, stockRatio,R7, vmwFinalPrice,Reference!$B$3, (1 - stockRatio) * vmwFinalPrice * numVmwShares),0)","type":"formula","format":"int_4dp","propagate":{"end":"V150"},"dataclass":"info"},
{"sheet":2,"id":"W4","data":"active amount"},
{"sheet":2,"id":"W5","data":"=SUM(W7:W)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":2,"id":"W7","data":"=SWITCH(Reference!$E$4,\"eTradeTransactionLog\", T7, \"eTradeHoldingRatio\",T7, \"eTradeLotQtyRatio\",U7,\"manualLotRatio\",V7)","type":"formula","format":"int_4dp","propagate":{"end":"W150"},"dataclass":"info"},
{"sheet":2,"id":"X3","data":"Basis adjustment for Dell dividends"},
{"sheet":2,"id":"X4","data":"1st special divident basis adjustment"},
{"sheet":2,"id":"X7","data":"=LET(purchaseDate,C7, dateOfRecord,Reference!$B$26, returnOfCapital,Reference!$C$26, IF(purchaseDate < dateOfRecord, returnOfCapital,0))","type":"formula","format":"financial","propagate":{"end":"X150"},"dataclass":"info"},
{"sheet":2,"id":"Y4","data":"2nd dividend basis adjustment"},
{"sheet":2,"id":"Y7","data":"=LET(purchaseDate,C7, dateOfRecord,Reference!$B$27, returnOfCapital,Reference!$C$27, IF(purchaseDate < dateOfRecord, returnOfCapital,0))","type":"formula","format":"financial","propagate":{"end":"Y150"},"dataclass":"info"},
{"sheet":2,"id":"Z3","data":"Tax basis entering merger"},
{"sheet":2,"id":"Z4","data":"VMW tax-basis per share"},
{"sheet":2,"id":"Z7","data":"=LET(actualPrice,E7, firstReturnOfCapital,X7, secondReturnOfCapital,Y7, IFERROR(actualPrice - firstReturnOfCapital - secondReturnOfCapital,0))","type":"formula","format":"financial","propagate":{"end":"Z150"},"dataclass":"info"},
{"sheet":2,"id":"AA4","data":"VMW tax-basis per lot"},
{"sheet":2,"id":"AA5","data":"=SUM(AA7:AA)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":2,"id":"AA7","data":"=Z7*D7","type":"formula","format":"int_3dp","propagate":{"end":"AA43"},"dataclass":"info"},
{"sheet":2,"id":"AA44","data":"=Z44*D44","type":"formula","format":"financial","propagate":{"end":"AA150"},"dataclass":"info"},
{"sheet":2,"id":"AB3","data":"AVGO shares received"},
{"sheet":2,"id":"AB4","data":"eTrade pro-rata"},
{"sheet":2,"id":"AB5","data":"=SUM(AB7:AB)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":2,"id":"AB7","data":"=LET(numVmwShares,D7, stockRatio,Reference!$B$5, vmwToAvgoRatio,Reference!$B$6, numVmwShares * stockRatio * vmwToAvgoRatio)","type":"formula","format":"int_6dp","propagate":{"end":"AB150"},"dataclass":"info"},
{"sheet":2,"id":"AC4","data":"eTrade derived per-lot","note":"This should exactly equal the value in the \"AVGO qty from eTrade\" column as it's literally inverted the calc.\n\nThis column is here purely for consistency so we can see all three stock columns together\n"},
{"sheet":2,"id":"AC5","data":"=SUM(AC7:AC)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":2,"id":"AC7","data":"=LET(numVmwShares,D7, stockRatio,Q7, vmwToAvgoRatio,Reference!$B$6, numVmwShares * stockRatio * vmwToAvgoRatio)","type":"formula","format":"int_6dp","propagate":{"end":"AC150"},"dataclass":"info"},
{"sheet":2,"id":"AD4","data":"manual per-lot"},
{"sheet":2,"id":"AD5","data":"=SUM(AD7:AD)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":2,"id":"AD7","data":"=LET(numVmwShares,D7, stockRatio,R7, vmwToAvgoRatio,Reference!$B$6, numVmwShares * stockRatio * vmwToAvgoRatio)","type":"formula","format":"int_6dp","propagate":{"end":"AD150"},"dataclass":"info"},
{"sheet":2,"id":"AE4","data":"active qty"},
{"sheet":2,"id":"AE5","data":"=SUM(AE7:AE)","type":"formula","format":"int_4dp","dataclass":"info"},
{"sheet":2,"id":"AE7","data":"=SWITCH(Reference!$E$4, \"eTradeTransactionLog\", AB7, \"eTradeHoldingRatio\",AB7, \"eTradeLotQtyRatio\",AC7,\"manualLotRatio\",AD7)","type":"formula","format":"int_6dp","propagate":{"end":"AE150"},"dataclass":"info"},
{"sheet":2,"id":"AF3","data":"Alternate gain calculation"},
{"sheet":2,"id":"AF4","data":"Gain (cash+FMV AVGO-basis)"},
{"sheet":2,"id":"AF5","data":"=SUM(AF7:AF)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":2,"id":"AF7","data":"=LET(numVmwShares,D7, vmwBasis,Z7, avgoQty,AE7, avgoFMV,Reference!$B$18, cashReceived,W7, gain,cashReceived+(avgoQty*avgoFMV)-(numVmwShares*vmwBasis),\nMAX(gain,0))","type":"formula","format":"financial","propagate":{"end":"AF150"},"dataclass":"info"},
{"sheet":2,"id":"AG4","data":"Fractional share","note":"Fraction attributed to the lot"},
{"sheet":2,"id":"AG5","data":"=SUM(AG7:AG)","type":"formula","format":"int_4dp","dataclass":"out_now"},
{"sheet":2,"id":"AG7","data":"=LET(useForFraction,J7, fractionAmount,Summary!$C$41, esppFractionLots,ESPP!$N$5, rsuFractionLots,RSU!J$5, IF(useForFraction, fractionAmount / (esppFractionLots+rsuFractionLots), 0))","type":"formula","format":"int_4dp","propagate":{"end":"AG150"},"dataclass":"info"},
{"sheet":2,"id":"AH2","data":"Now"},
{"sheet":2,"id":"AH3","data":"Gain"},
{"sheet":2,"id":"AH4","data":"Fraction"},
{"sheet":2,"id":"AH5","data":"=SUM(AH7:AH)","type":"formula","format":"int_4dp","dataclass":"out_now"},
{"sheet":2,"id":"AH7","data":"=LET(useForFraction,J7, fractionSaleFMV,Reference!$B$23, postMergerBasis,AT7, lotFractionAmount,AG7, IF(useForFraction, (fractionSaleFMV - postMergerBasis)*lotFractionAmount, 0))","type":"formula","format":"int_4dp","propagate":{"end":"AH150"},"dataclass":"out_now"},
{"sheet":2,"id":"AI4","data":"Merger"},
{"sheet":2,"id":"AI5","data":"=SUM(AI7:AI)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":2,"id":"AI7","data":"=LET(cashReceived,W7, alternateGainAmount,AF7, MIN(cashReceived, alternateGainAmount))","type":"formula","format":"financial","propagate":{"end":"AI150"},"dataclass":"out_now"},
{"sheet":2,"id":"AJ3","data":"Treatment"},
{"sheet":2,"id":"AJ4","data":"Income & short term gain"},
{"sheet":2,"id":"AJ5","data":"=SUM(AJ7:AJ)","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":2,"id":"AJ7","data":"=LET(\npurchaseDate,C7,\nmergerDate,Reference!$B$28,\nlotFractionGain,AH7,\nmergerGain,AI7,\nIF(DATEDIF(purchaseDate,mergerDate,\"Y\")>=1,\n  0,\n  lotFractionGain + mergerGain\n))","type":"formula","format":"financial","propagate":{"end":"AJ150"},"dataclass":"out_now"},
{"sheet":2,"id":"AK4","data":"Long term gain"},
{"sheet":2,"id":"AK5","data":"=SUM(AK7:AK)","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":2,"id":"AK7","data":"=LET(\npurchaseDate,C7,\nmergerDate,Reference!$B$28,\nlotFractionGain,AH7,\nmergerGain,AI7,\nIF(DATEDIF(purchaseDate,mergerDate,\"Y\")>=1,\n  lotFractionGain+mergerGain,\n  0\n))","type":"formula","format":"financial","propagate":{"end":"AK150"},"dataclass":"out_now"},
{"sheet":2,"id":"AL3","data":"Form 8949","note":"https://costbasis.com/calculators/cashtobootmerger.html\n\nNotes two ways to approach Form 8949:\n1. report just the cash portion as proceeds and adjust cost basis down so delta is the appropriate gain\n2. report the true compensation (cash+fmv shares) and provide the appropriate basis.\n\nI'm going with the latter because:\n1. it more accurately captures the reality of the merger\n2. it's the basis that I can conceptually reconcile with the f8937 mandated future basis."},
{"sheet":2,"id":"AL4","data":"Form Section"},
{"sheet":2,"id":"AL7","data":"=IF(DATEDIF(C7,Reference!$B$28,\"Y\")>=1,\"Part II Box E\",\"Part I Box B\")","type":"formula","format":"financial","propagate":{"end":"AL150"},"dataclass":"out_now"},
{"sheet":2,"id":"AM4","data":"Acquisition Date"},
{"sheet":2,"id":"AM7","data":"=C7","type":"formula","format":"iso-date","propagate":{"end":"AM150"},"dataclass":"out_now"},
{"sheet":2,"id":"AN4","data":"1099-B Proceeds","note":"This is the pro-rata cash portion that eTrade have used per lot and reported on the 1099-B.\n\nThis is useful to disambiguate which lot is which when there are multiple on a single date.\n"},
{"sheet":2,"id":"AN7","data":"=T7","type":"formula","format":"financial","propagate":{"end":"AN150"},"dataclass":"out_now"},
{"sheet":2,"id":"AO4","data":"Proceeds (d)","note":"From https://www.irs.gov/instructions/i8949\nfor Column (d)â€”Proceeds (Sales Price)\n\n\"If the proceeds you received were more than shown on Form 1099-B or 1099-S (or substitute statement), enter the correct proceeds in column (d). This might happen if, for example, box 4 on Form 1099-S is checked.\"\n\n"},
{"sheet":2,"id":"AO5","data":"=SUM(AO7:AO)","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":2,"id":"AO6","data":"NOTE: costbasis.com recommends attaching a statement explaining the adjustment to proceeds"},
{"sheet":2,"id":"AO7","data":"=LET(\ncashReceived,W7, \navgoQty,AE7, \nproceedsStyle,Reference!$E$9, \navgoFMV,Reference!$B$18, \nSWITCH(proceedsStyle, \"combined\", cashReceived +(avgoQty*avgoFMV), \"cashOnly\", cashReceived))","type":"formula","format":"financial","propagate":{"end":"AO150"},"dataclass":"out_now"},
{"sheet":2,"id":"AP4","data":"1099-B basis (e)"},
{"sheet":2,"id":"AP5","data":"=SUM(AP7:AP)","type":"formula","format":"financial","dataclass":"info"},
{"sheet":2,"id":"AP7","data":"=LET(\nproceedsStyle,Reference!$E$9,\nproceeds,AO7,\ngain,AS7,\nnumVmwShares,D7, \nvmwBasis, Z7, \navgoQty,AE7, \navgoFMV,Reference!$B$18, \ncashReceived,W7, \navgoTotalValue, avgoFMV*avgoQty, \nvmwTotalBasis, vmwBasis*numVmwShares,\nalternateGainAmount,AF7, \nSWITCH(proceedsStyle,\n  \"cashOnly\",\n    proceeds - gain,\n  \"combined\",\n    IF(cashReceived<alternateGainAmount,\n      avgoTotalValue,\n      vmwTotalBasis\n    )\n  )\n)","type":"formula","format":"financial","propagate":{"end":"AP150"},"dataclass":"out_now"},
{"sheet":2,"id":"AQ4","data":"Code (f)"},
{"sheet":2,"id":"AQ7","data":"=IF(AR7=0,,\"B\")","type":"formula","format":"financial","propagate":{"end":"AQ150"},"dataclass":"out_now"},
{"sheet":2,"id":"AR4","data":"Adjustment (g)","note":"Using calc from https://www.irs.gov/instructions/i8949#en_US_2022_publink1000114401\n\nIt's negative because the Form instructions require gain to be:\nd - e + g"},
{"sheet":2,"id":"AR5","format":"financial"},
{"sheet":2,"id":"AR7","data":"0","format":"financial","propagate":{"end":"AR150"},"dataclass":"out_now"},
{"sheet":2,"id":"AS4","data":"Gain (h)","note":"Not allowed to recognize a loss. I'm assuming that applies at a share level rather than the aggregate holding absent explicit indication otherwise."},
{"sheet":2,"id":"AS5","data":"=SUM(AS7:AS)","type":"formula","format":"financial","dataclass":"out_now"},
{"sheet":2,"id":"AS7","data":"=LET(\nproceedsStyle,Reference!$E$9,\nproceeds,AO7,\nbasis1099B,AP7,\nadjustment,AR7,\nmergerGain,AI7,\nSWITCH(proceedsStyle,\n  \"cashOnly\",\n    mergerGain,\n  \"combined\",\n    MAX(proceeds - basis1099B + adjustment, 0)\n))","type":"formula","format":"financial","propagate":{"end":"AS150"},"dataclass":"out_now"},
{"sheet":2,"id":"AT2","data":"Post Merger"},
{"sheet":2,"id":"AT3","data":"Reference for sale post-merger"},
{"sheet":2,"id":"AT4","data":"AVGO tax-basis per share"},
{"sheet":2,"id":"AT7","data":"=LET(vmwBasis,Z7, numVmwShares,D7, cashReceived,W7, gainRecognized,AI7, avgoQty,AE7,IFERROR( ((vmwBasis*numVmwShares) - cashReceived + gainRecognized)/avgoQty, \"n/a\"))","type":"formula","format":"financial","propagate":{"end":"AT150"},"dataclass":"out_future"},
{"sheet":2,"id":"AU4","data":"Potential Captial Gain (AVGO)"},
{"sheet":2,"id":"AU5","data":"=SUM(AU7:AU)","type":"formula","format":"financial","dataclass":"out_future"},
{"sheet":2,"id":"AU7","data":"=LET(saleFMV,Reference!$B$10, postMergerBasis,AT7, avgoQty,AE7, lotFractionAmount,AG7, iferror((saleFMV - postMergerBasis) * (avgoQty - lotFractionAmount), 0))","type":"formula","format":"financial","propagate":{"end":"AU150"},"dataclass":"out_future"},
{"sheet":2,"id":"AV4","data":"Short Term Capital Gain"},
{"sheet":2,"id":"AV5","data":"=SUM(AV7:AV)","type":"formula","format":"financial","dataclass":"out_future"},
{"sheet":2,"id":"AV7","data":"=LET(\navgoQty,AE7, \npurchaseDate,C7,\npostMergerSaleDate,Reference!$B$29,\nsaleFMV,Reference!$B$10,\npostMergerBasis,AT7, \nIFERROR(IF(DATEDIF(purchaseDate,postMergerSaleDate,\"Y\")>=1,\n  0,\n  avgoQty * (saleFMV - postMergerBasis)\n),0))","type":"formula","format":"financial","propagate":{"end":"AV150"},"dataclass":"out_future"},
{"sheet":2,"id":"AW4","data":"Long Term Capital Gain"},
{"sheet":2,"id":"AW5","data":"=SUM(AW7:AW)","type":"formula","format":"financial","dataclass":"out_future"},
{"sheet":2,"id":"AW7","data":"=LET(\navgoQty,AE7, \npurchaseDate,C7,\npostMergerSaleDate,Reference!$B$29,\nsaleFMV,Reference!$B$10,\npostMergerBasis,AT7, \nIFERROR(IF(DATEDIF(purchaseDate,postMergerSaleDate,\"Y\")>=1,\n  avgoQty * (saleFMV - postMergerBasis),\n  0\n),0))","type":"formula","format":"financial","propagate":{"end":"AW150"},"dataclass":"out_future"},
